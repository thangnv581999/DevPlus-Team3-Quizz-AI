<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body>
    <div
      id="chatbox"
      style="
        border: 1px solid #ccc;
        padding: 10px;
        width: 300px;
        height: 400px;
        overflow-y: scroll;
      "
    >
      <div id="messages"></div>
    </div>
    <input type="text" id="userInput" placeholder="Type your message..." />
    <button id="sendButton">Send</button>

    <script>
      const apiKey = "AIzaSyChs02VvwUeRB0eoh_bf5auW0HbwH2FMco";
      const sendButton = document.getElementById("sendButton");
      const userInput = document.getElementById("userInput");
      const messages = document.getElementById("messages");

      sendButton.addEventListener("click", async () => {
        const userMessage = userInput.value;
        messages.innerHTML += `<div>User: ${userMessage}</div>`;
        userInput.value = "";

        // Gửi yêu cầu đến API Gemini
        const response = await fetch(
          `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`,
          {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
            },
            body: JSON.stringify({
              contents: [
                {
                  role: "user",
                  parts: [
                    {
                      text: userMessage,
                    },
                  ],
                },
              ],
              generationConfig: {
                temperature: 1,
                topK: 40,
                topP: 0.95,
                maxOutputTokens: 8192,
                responseMimeType: "text/plain",
              },
            }),
          }
        );

        const data = await response.json();
        console.log(data); // In ra toàn bộ phản hồi

        // Trích xuất nội dung từ phản hồi
        const aiResponse = data.candidates[0]?.content?.parts[0]?.text || 'No response';
        messages.innerHTML += `<div>AI: ${aiResponse}</div>`;
      });
    </script>
  </body>
</html>
